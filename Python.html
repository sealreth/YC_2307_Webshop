<!DOCTYPE html>
<html>
<head>
    <title>Festival Store Information</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <button onclick="window.location.href = 'index.html';">HOME</button>
    <h1>Festival Store Information</h1>
    <table id="storeData">
        <thead>
            <tr> 
                <th>Age</th>
                <th>Age Group</th>
                <th>Amount</th>
                <th>Cust_name</th>
                <th>Gender</th>
                <th>Marital_Status</th>
                <th>Occupation</th>
                <th>Orders</th>
                <th>Product_Category</th>
                <th>Product_ID</th>
                <th>State</th>
                <th>User_ID</th>
                <th>Zone</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- Data fetched from the server will be added here -->
        </tbody>
    </table>

    <canvas id="productCategoryChart" width="400" height="200"></canvas>

    <script>
        fetch("https://gray-field-0aa5fb003.3.azurestaticapps.net/tom")
        .then(response => response.json())
        .then(data => {
            const tableBody = document.getElementById('tableBody');

            data.forEach(row => {
                const newRow = document.createElement('tr');
                const columnsToDisplay = ["Age", "Age Group", "Amount", "Cust_name", "Gender", "Marital_Status", "Occupation", "Orders", "Product_Category", "Product_ID", "State", "User_ID", "Zone"];
                
                columnsToDisplay.forEach(column => {
                    const cell = document.createElement('td');
                    cell.textContent = row[column];
                    newRow.appendChild(cell);
                });

                tableBody.appendChild(newRow);
            });

            // Extract product categories and their counts
            const productCategories = data.reduce((acc, row) => {
                const category = row["Product_Category"];
                acc[category] = (acc[category] || 0) + 1;
                return acc;
            }, {});

            // Get the canvas element and create the chart
            const ctx = document.getElementById('productCategoryChart').getContext('2d');
            const productCategoryChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(productCategories),
                    datasets: [{
                        label: 'Product Category Distribution',
                        data: Object.values(productCategories),
                        backgroundColor: 'rgba(75, 192, 192, 0.2)', // You can customize the colors here
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });
    </script>
</body>
</html>
