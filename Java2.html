<!DOCTYPE html>
<html>
<head>
    <title>Account Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="js/base.js"></script>
</head>
<body>
    <div class="container">
        <div class="col-12"> <h1>Account Management</h1> </div>
        <div class="row">
            <div class="col-12 col-md-6 col-lg-3">
                <table>
                    <tr>
                        <th>Veld</th>
                        <th>Waarde</th>
                    </tr>
                    <tr>
                        <td>ID:</td>
                        <td><input id="idinput"></td>
                    </tr>
                    <tr>
                        <td>Naam:</td>
                        <td><input id="usernameinput"></td>
                    </tr>
                    <tr>
                        <td>Leeftijd</td>
                        <td><input id="ageinput"></td>
                    </tr>
                    <tr>
                        <td>Email:</td>
                        <td><input id="emailinput"></td>
                    </tr>
                    <tr>
                        <td>Password</td>
                        <td><input id="passwordinput"></td>
                    </tr>
                    <tr>
                        <td>Gender</td>
                        <td><input id="genderinput"></td>
                    </tr>
                </table>
            </div>
            <div class="col-12 col-md-6 col-lg-3">
                <br>
                <button type="button" class="btn btn-dark" onclick="saveAccount()">Save</button>
                <br>
                <button type="button" class="btn btn-dark" onclick="fetchAccounts()">Show Accounts</button>
                <br>
                <button type="button" class="btn btn-dark" onclick="updateAccount()">Update</button>
                <br>
                <button type="button" class="btn btn-dark" onclick="deleteAccount()">Delete</button>
                <br>
                <div id="resultMessage"></div>
                <br>
            </div>
        </div>
        <script>
            function fetchAccounts() {
                fetch(BACKEND_URL + "/api/accounts")
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.getElementById('tableBody');
                    
                    tableBody.innerHTML = '';
        
                    data.forEach(account => {
                        const newRow = document.createElement('tr');
                        const columnsToDisplay = ["id", "naam", "leeftijd", "email", "gender"];
        
                        columnsToDisplay.forEach(column => {
                            const cell = document.createElement('td');
                            cell.textContent = account[column];
                            newRow.appendChild(cell);
                        });
        
                        tableBody.appendChild(newRow);
                    });
                })
                .catch(error => {
                    console.error('Error fetching account data:', error);
                });
            }
        
            
            fetchAccounts();
        
            function saveAccount() {
                const newAccount = {
                    username: document.getElementById("usernameinput").value,
                    leeftijd: document.getElementById("ageinput").value,
                    email: document.getElementById("emailinput").value,
                    password: document.getElementById("passwordinput").value,
                    gender: document.getElementById("genderinput").value
                    
                };
        
                fetch(BACKEND_URL + "/api/saveaccounts", {
                    method: 'POST',
                    headers: {"Content-type": "application/json"},
                    body: JSON.stringify(newAccount)
                })
                .then(response => {
                    if (response.ok) {
                        console.log("Account successfully saved.");
                        fetchAccounts(); 
                    } else {
                        console.log("Failed to save account.");
                    }
                })
                .catch(error => {
                    console.error("Error occurred while saving account:", error);
                });
            }
        
            function updateAccount() {
                const accountId = document.getElementById("idinput").value;
                const updatedAccount = {
                    username: document.getElementById("usernameinput").value,
                    leeftijd: document.getElementById("ageinput").value,
                    email: document.getElementById("emailinput").value,
                    password: document.getElementById("passwordinput").value,
                    gender: document.getElementById("genderinput").value
                };
        
                fetch(`https://yc2307javaapp.azurewebsites.net/api/updateaccounts/${accountId}`, {
                    method: 'PUT',
                    headers: { "Content-type": "application/json" },
                    body: JSON.stringify(updatedAccount)
                })
                .then(response => {
                    if (response.ok) {
                        console.log("Account successfully updated.");
                        fetchAccounts();
                    } else {
                        console.log("Failed to update account.");
                    }
                })
                .catch(error => {
                    console.error("Error occurred while updating account:", error);
                });
            }
        
            function deleteAccount() {
                const accountId = document.getElementById("idinput").value;
        
                fetch(`https://yc2307javaapp.azurewebsites.net/api/deleteaccounts/${accountId}`, {
                    method: 'DELETE',
                    headers: { "Content-type": "application/json" }
                })
                .then(response => {
                    if (response.ok) {
                        console.log("Account successfully deleted.");
                        fetchAccounts();
                    } else {
                        console.log("Failed to delete account.");
                    }
                })
                .catch(error => {
                    console.error("Error occurred while deleting account:", error);
                });
            }
        </script>
        
        <table id="storeData" style="display: none; border: 1px solid black">

            <thead>
                <tr>
                    <th>id</th>
                    <th>username</th>
                    <th>leeftijd</th>
                    <th>email</th>
                    <th>password</th>a
                    <th>gender</th>
                </tr>
            </thead>
            
            
            
            
            
        
            <tbody id="tableBody">
                <!-- Data fetched from the server will be added here -->
            </tbody>
        </table>
</body>
</html>
