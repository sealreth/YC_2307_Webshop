<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Heatmap</title>
  <!-- Add Plotly.js library -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <div id="heatmap"></div>

  <script>
    // Fetch JSON data from the URL
    fetch('http://127.0.0.1:5000/HeatmapAgeProdID')
      .then(response => response.json())
      .then(data => {
        // Extract data from the JSON
        const ageGroups = Array.from(new Set(data.map(entry => entry["Age Group"])));
        const productCategories = Array.from(new Set(data.map(entry => entry.Product_Category)));

        // Create a 2D array to store the heatmap data
        const heatmapData = [];

        // Populate the heatmap data array
        for (let i = 0; i < ageGroups.length; i++) {
          const row = productCategories.map(category => {
            const dataIndex = data.findIndex(entry => entry["Age Group"] === ageGroups[i] && entry.Product_Category === category);
            return dataIndex !== -1 ? data[dataIndex].Amount : 0;
          });
          heatmapData.push(row);
        }

        // Create the heatmap trace using Plotly.js
        const trace = {
          x: productCategories,
          y: ageGroups,
          z: heatmapData,
          type: 'heatmap',
          colorscale: 'Viridis',
        };

        // Define the layout of the heatmap
        const layout = {
          title: 'Heatmap of Amount by Age Group and Product Category',
          xaxis: { title: 'Product Category' },
          yaxis: { title: 'Age Group' },
        };

        // Plot the heatmap
        Plotly.newPlot('heatmap', [trace], layout);
      })
      .catch(error => console.error('Error fetching data:', error));
  </script>
</body>
</html>

Code is niet correct, pakt niet de sum van amount